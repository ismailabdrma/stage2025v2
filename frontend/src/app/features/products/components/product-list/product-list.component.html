<div class="product-list-container">
  <div class="header">
    <h2>Products</h2>
    <div class="filters">
      <mat-form-field appearance="outline">
        <mat-label>Search products</mat-label>
        <input matInput [(ngModel)]="searchTerm" (input)="onSearch()">
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>
      
      <mat-form-field appearance="outline">
        <mat-label>Category</mat-label>
        <mat-select [(ngModel)]="selectedCategory" (selectionChange)="onCategoryChange()">
          <mat-option value="">All Categories</mat-option>
          <mat-option *ngFor="let category of categories" [value]="category.name">
            {{ category.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
  </div>

  <div *ngIf="loading" class="loading-container">
    <mat-spinner></mat-spinner>
    <p>Loading products...</p>
  </div>

  <div class="products-grid" *ngIf="!loading">
    <mat-card *ngFor="let product of filteredProducts" class="product-card">
      <img mat-card-image [src]="product.imageUrls[0] || '/placeholder.svg?height=200&width=300'" 
           [alt]="product.name" class="product-image">
      
      <mat-card-header>
        <mat-card-title>{{ product.name }}</mat-card-title>
        <mat-card-subtitle>{{ product.categoryName }}</mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <p class="product-description">{{ product.description | slice:0:100 }}...</p>
        <div class="product-price">
          <span class="price">${{ product.displayedPrice | number:'1.2-2' }}</span>
          <span class="supplier">by {{ product.supplierName }}</span>
        </div>
        <div class="product-stock" *ngIf="product.syncedStock !== undefined">
          <mat-icon [color]="product.syncedStock > 0 ? 'primary' : 'warn'">
            {{ product.syncedStock > 0 ? 'check_circle' : 'error' }}
          </mat-icon>
          <span>{{ product.syncedStock > 0 ? 'In Stock (' + product.syncedStock + ')' : 'Out of Stock' }}</span>
        </div>
      </mat-card-content>

      <mat-card-actions>
        <button mat-button [routerLink]="['/products', product.id]">
          <mat-icon>visibility</mat-icon>
          View Details
        </button>
        <button mat-raised-button color="primary" 
                (click)="addToCart(product)" 
                [disabled]="product.syncedStock === 0">
          <mat-icon>shopping_cart</mat-icon>
          Add to Cart
        </button>
      </mat-card-actions>
    </mat-card>
  </div>

  <div *ngIf="!loading && filteredProducts.length === 0" class="no-products">
    <mat-icon>inventory</mat-icon>
    <h3>No products found</h3>
    <p>Try adjusting your search or filter criteria.</p>
  </div>
</div>
